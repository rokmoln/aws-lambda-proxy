{"version":3,"sources":["../src/env.js"],"names":[],"mappings":";;;;;;;;;AAAA;;;;AACA;;;;;;AAEO,IAAI,0BAAS,QAAQ,IAAR,CAAa,QAAQ,GAAR,CAAY,QAAzB,CAAb;;AAEP,0BAAE,QAAF,CAAW,QAAQ,GAAnB,EAAwB;AACtB,QAAM,MADgB;AAEtB,cAAY,EAFU;AAGtB,cAAY,EAHU;AAItB,aAAW,MAJW;AAKtB,YAAU,EALY;AAMtB,aAAW;AANW,CAAxB;;AASA,IAAI,eAAJ,EAAa;AACX,4BAAE,QAAF,CAAW,QAAQ,GAAnB,EAAwB;AACtB,gBAAY,WADU;AAEtB,gBAAY,MAFU;AAGtB,2BAAuB;AAHD,GAAxB;;AAMA,QAAM,eAAN,GAAwB,QAAxB;AACD;;AAED;;AAEO,IAAI,wBAAQ;AACjB;AAAA,wCAAa,aAAiB;AAC5B,YAAM,IAAI,KAAJ,CAAU,gCAAV,CAAN;AACD,KAFD;;AAAA;AAAA;AAAA;AAAA,MADiB;AAIjB;AAAA,yCAAe,aAAiB;AAC9B,YAAM,IAAI,KAAJ,CAAU,kCAAV,CAAN;AACD,KAFD;;AAAA;AAAA;AAAA;AAAA,MAJiB;AAOjB;AAAA,yCAAW,aAAiB;AAC1B,YAAM,IAAI,KAAJ,CAAU,8BAAV,CAAN;AACD,KAFD;;AAAA;AAAA;AAAA;AAAA;AAPiB,CAAZ;;AAYP,IAAI,QAAQ,GAAR,CAAY,YAAhB,EAA8B;AAC5B,UAbS,KAaT,WAAQ,QAAQ,QAAQ,GAAR,CAAY,YAApB,CAAR;AACD,CAFD,MAEO;AACL,UAAQ,KAAR,CAAe,oCAAf;AACA;AACA,UAAQ,IAAR,CAAa,CAAb;AACD;;AAEM,IAAI,oBAAM;AACf,WAAS,WADM;AAEf,aAAW,iBAAS,aAAG,IAAH,GAAU,MAAnB,GAA4B,CAFxB;AAGf,aAAW;AACT,cAAU,EADD,EACK;AACd,qBAAiB,SAFR,CAEkB;AAFlB,GAHI;AAOf,wBAPe;AAQf,sBARe;AASf,OAAK;AACH,WAAO,QAAQ,GAAR,CAAY,SADhB;AAEH,WAAO,SAFJ,CAEc;AAFd,GATU;AAaf,QAAM,QAAQ,GAAR,CAAY;AAbH,CAAV","file":"env.js","sourcesContent":["import _ from 'lodash-firecloud';\nimport os from 'os';\n\nexport let isProd = /^prod/.test(process.env.NODE_ENV);\n\n_.defaults(process.env, {\n  PORT: '8081',\n  DEBUG_HOST: '',\n  DEBUG_PORT: '',\n  LOG_LEVEL: 'INFO',\n  NODE_ENV: '',\n  NODE_PATH: ''\n});\n\nif (!isProd) {\n  _.defaults(process.env, {\n    DEBUG_HOST: 'localhost',\n    DEBUG_PORT: '9999',\n    NODE_HEAPDUMP_OPTIONS: 'nosignal'\n  });\n\n  Error.stackTraceLimit = Infinity;\n}\n\n// MAIN\n\nexport let hooks = {\n  findLambdas: async function() {\n    throw new Error('\"findLambdas\" hook not defined');\n  },\n  preRouteSetup: async function() {\n    throw new Error('\"preRouteSetup\" hook not defined');\n  },\n  preHandle: async function() {\n    throw new Error('\"preHandle\" hook not defined');\n  }\n};\n\nif (process.env.HOOKS_MODULE) {\n  hooks = require(process.env.HOOKS_MODULE);\n} else {\n  console.error(`Env variable HOOKS_MODULE not set!`);\n  // eslint-disable-next-line no-process-exit\n  process.exit(1);\n}\n\nexport let env = {\n  address: '127.0.0.1',\n  forkCount: isProd ? os.cpus().length : 0,\n  heartbeat: {\n    interval: 15, // minutes, 0 to disable\n    memThresholdRss: undefined // MB\n  },\n  isProd,\n  hooks,\n  log: {\n    level: process.env.LOG_LEVEL,\n    toDir: undefined // isProd ? undefined : '.'\n  },\n  port: process.env.PORT\n};\n\nexport default env;\n"]}